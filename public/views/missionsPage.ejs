<!doctype html>
<html lang="en" id="missions-html" style="overflow-x:hidden;">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <link rel="shortcut icon" href="favicon.png" type="image/x-icon">
    <!--CSSHAKE-->
    <link rel="stylesheet" type="text/css" href="https://csshake.surge.sh/csshake.min.css">    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Caveat&family=Poppins&family=Recursive&family=Belgrano&family=Bellota&family=Handlee&family=Rye&family=ZCOOL+XiaoWei&display=swap" rel="stylesheet">
    <!-- bootstrap5-->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link rel="stylesheet" href="styles/style.css">

    <script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>
    <title>Hanford Lam | Piano Teacher</title>
    <!-- CURSOR -->
    <style>HTML,BODY{cursor: url("../../images/cursor.cur"), auto;}</style>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-S7KLNXVSDD"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-S7KLNXVSDD');
    </script>
  </head>
  <body class="container-fluid background-transparent">
    <!-- NAVBAR -->
    <nav id="myNav" class="rounded recursive row align-items-center text-center py-2 w-auto">
      <div class="col-lg-5">
        <a id="navIcon" class="my-2 d-block" href='/'>Hanford Lam | Piano Teacher</a>
      </div>
      <div class="col-lg-7">
        <a id="practiceTab" href="/practice" class="mx-4 my-2 d-inline-block navLink">PRACTICE</a>
        <a id="missionsTab" href="/missions" class="mx-4 my-2 d-inline-block navLink">MISSIONS</a>
        <a id="leaderboardTab" href="/leaderboard" class="mx-4 my-2 d-inline-block navLink">POINTS</a>
        <form id="logoutButton" class="mx-4 my-2 d-inline-block" action="/logout" method="POST">
          <input type="hidden" name="_csrf" value="<%= csrfToken %>">
          <button type="submit" class="btn btn-sm btn-secondary">LOG OUT</button>
        </form>        
      </div>
    </nav>
    

      <!-- DYNAMIC NAVBAR AND TITLE -->
      <script>
        let currentPath = window.location.pathname
        if (currentPath == '/practice') {
          document.getElementById("practiceTab").classList.add("orange-text")
          document.title = "Portal - Hanford Lam"
        } else if (currentPath == '/missions') {
          document.getElementById("missionsTab").classList.add("orange-text")
          document.title = "Portal - Hanford Lam"
        } else if (currentPath == '/leaderboard') {
          document.getElementById("leaderboardTab").classList.add("orange-text")
          document.title = "Portal - Hanford Lam"
        }
      </script>
      <div id="container" class="container">
<!-- FONT AWESOME BOUNCING ARROW-->
<script src="https://kit.fontawesome.com/25ae9b8317.js" crossorigin="anonymous"></script>
<!-- PS2P font -->
<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">

<!-- ERRORS -->
<% adErrors.forEach(function(message) { %>
  <div class="alert alert-danger text-center small py-1 mt-2"><%= message %></div>
<% }) %>

<!--WALLET-->
<%- include('includes/wallet') %>

<!-- MINI MISSIONS -->
<!-- keep csrf token accessible, use lowercase for dataset entries! -->
<span id="csrf-landmark" data-value="<%= csrfToken %>" data-username="<%= username %>" data-studentid="<%= userId %>"></span>

<div class="mt-5 aboveFalling" id="missionsWrapper">
  <!--MISSIONS ACCOMPLISHED-->
  <div class="w-100">
    <div class="black-bg belgrano rounded d-inline-block">
    <h3 class="p-3 orange-text" style="font-size: 2em;">ðŸ‘‘ Missions ACCOMPLISHED ðŸ‘‘</h3>
  </div>
  </div>
  
  <% missionsAccomplished.forEach((mission) => { %>
    <div class="rounded shake-opacity task-div-complete">
      <div class="missionContent recursive">
        <%- mission %>
      </div>
    </div>
  <% }) %>
</div>


  <!--BOUNCING ARROW-->
  <div class="aboveFalling arrowcontainer">
    <div class="arrow-holder">
      <div id="arrow" class="circle bounce">
          <i class="fas fa-angle-double-down fa-4x drop-arrow"></i>
      </div>
    </div>
  </div>

  <!-- INTERESTING VIDEO 
  <div id="interestingVideoContainer" class="aboveFalling">
    <% if(interestingVideoURL){ %>
    <p class="blue-box text-center mb-0 py-4 rounded recursive"><%- interestingVideoPrompt %></p>
    <div class="responsive-container">
      <iframe loading="lazy" style="z-index: 99999;" class="mb-5" width="100%" height="500px" src="<%= interestingVideoURL %>" title="Hanford's Video Pick" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
    </div>
    <% } %>
  </div>-->

    <!-- LITERACY -->
    <div class="aboveFalling p-5 m-5 blue-box rounded">
      <div class="m-5">
        <p class="recursive"><strong>June AURAL Mission:</strong><br>1. Ask Hanford to run the aural tests for your level.<br>2. Get an A+ score for all the tests.</p>
      </div>
    </div>

        <!-- READING -->
        <div class="aboveFalling blue-box p-5 m-5 rounded">
          <div class="m-5">
          <p class="recursive"><strong>June KNOWLEDGE Mission:</strong><br>1. Ask Hanford to test 10 general knowledge questions.<br>2. Answer 8 or more correctly.</p>
        </div>
        </div>

            <!--DISPLAY CONVERSATION-->
            <div class="d-flex justify-content-center" style=" min-width:0;">
              <div class="d-flex flex-column" style=" min-width:0;">
                <div id="practiceConversationContainer" class="d-flex flex-column topShadow rounded my-5 py-3" style="max-width:960px; min-width:0; z-index: 1;overflow-y: scroll;height:400px;">
                  <div id="practiceConversation" class="mx-auto px-4" style="z-index: 100; min-width:0; max-width: 100%;">
                    <% practiceConversation.forEach((entry) => { 
                      if(entry[0] == 'You') { %>
                        <div class="convo-p-wrapper black-text px-3 py-2 my-3 rounded" style="background-color: rgba(255, 255, 255, 0.97)"><strong class="orange-text"><%= entry[0] %></strong> <%- filterUserHTML(entry[1]) %></div>
                      <% } else if(entry[0] == 'Hanford') { %>
                        <div class="convo-p-wrapper black-text px-3 py-2 my-3 rounded" style="background-color: rgba(255, 255, 255, 0.97)"><strong class="purple-text"><%= entry[0] %></strong> <%- filterUserHTML(entry[1]) %></div>
                      <% }
                    }) %>
                    <div style="height:15px;"></div>
                  </div>
                    <!--DISPLAY REPLY BOX IF NO PRACTICE STATUS-->
                    <% if (!practiceStatus) { %>
                      <form id="PracticeConvo" class="m-4" style="max-width:960px;" action="/updateLastSubmittedDateAndAddPoints" method="POST">
                        <input type="hidden" name="_csrf" value="<%= csrfToken %>">
                        <div class="form-group text-center" style="width:100%;margin:0 auto;">
                          <textarea autocomplete="off" name="practiceConversation" class="form-control" style="background-color: rgba(30, 20, 51, 0.927);color:chartreuse;" 
                          placeholder="<%= practicePrompt %>&#10; &#10;" id="practiceConversation" rows="6"></textarea>
                          <div class="d-grid">
                            <button  type="submit" class="btn btn-danger btn-block mt-4" style="font-size: 1.2rem; border:3px solid white">SEND</button>
                          </div>
                          
                        </div>
                      </form>
                    <% } else { %>
                      <div id="practice-success" class="recursive text-center mt-5 my-2">
                        <p class="black-bg d-inline-block p-3 rounded"><span class="green-text">Hanford will reply soon! Ask Mum or Dad if you need to send another message.</span><br><span class="orange-text">3 points have been added to your wallet.</span></p>
                      </div>
                    <% } %>
              
                </div>


              
              <script>
                let practiceConversationContainer = document.getElementById('practiceConversationContainer')
                practiceConversationContainer.scrollTop = practiceConversationContainer.scrollHeight

                // prevent multisubmits
          try {
            (function() {
              let frm = document.getElementById("PracticeConvo")
              var allowSubmit = true;
              frm.onsubmit = function () {
                if (allowSubmit)
                    allowSubmit = false;
                else 
                    return false;
              }
            })();
          } catch(err) {
            console.log(err);
          }
              </script>
              
              </div>
          
            </div>

  <!-- READING PRACTICE 
  <div id="readingPracticeContainer" class="aboveFalling mt-5">
    <% if(readingPracticePDFPath){ %>
    <p class="blue-box text-center py-4 rounded recursive"><%- readingPracticePrompt %></p>
    <p class="blue-box text-center pb-4 rounded recursive mb-0">Here is the <a href="<%= readingPracticePDFPath %>" target="_blank">PDF</a> file.</p>
    <iframe loading="lazy" src="<%= readingPracticePDFPath %>" width="100%" height="1000px"></iframe>
    <% } %>
  </div>-->

  <!--BOUNCING ARROW
  <div class="aboveFalling arrowcontainer">
    <div class="arrow-holder">
      <div id="arrow" class="circle bounce">
          <i class="fas fa-angle-double-down fa-4x drop-arrow"></i>
      </div>
    </div>
  </div>-->

  <!-- CLUMSY BIRD 
  <div class="responsive-container-3-2">
    <iframe loading="lazy" class="aboveFalling rounded responsive-iframe" src="..\files\ClumsyBird\index.html" frameborder="0"></iframe>
  </div>-->

  <!--2048
  <div style="margin: 0 auto; max-width:800px;"><iframe loading="lazy" class="aboveFalling rounded mt-5" id="game2048" src="..//files//2048//index.html" frameborder="0"></iframe></div>-->

  <!--BOUNCING ARROW
  <div class="aboveFalling arrowcontainer">
    <div class="arrow-holder">
      <div id="arrow" class="circle bounce">
          <i class="fas fa-angle-double-down fa-4x drop-arrow"></i>
      </div>
    </div>
  </div>-->

  <!--pacman
  <div class="aboveFalling white-text text-center mt-5 mb-0 pt-4 pb-0 ps2p" style="background-color:#000; max-width: 800px; margin: 0 auto;">
    <p class="my-3 purple-text">GLOBAL HIGHSCORES</p>
    <p>Pac-man: <span class="orange-text"><%= pacmanHighscores[0][0]%></span> <span class="green-text"><%= pacmanHighscores[0][1]%></span><br>Pac-man Turbo <span class="orange-text"><%= pacmanHighscores[1][0]%></span> <span class="green-text"><%= pacmanHighscores[1][1]%></span></p>
    <p>Ms Pac-man <span class="orange-text"><%= pacmanHighscores[2][0]%></span> <span class="green-text"><%= pacmanHighscores[2][1]%></span><br>Ms Pac-man Turbo <span class="orange-text"><%= pacmanHighscores[3][0]%></span> <span class="green-text"><%= pacmanHighscores[3][1]%></span></p>
    <p class="mb-0 pb-0">Cookie-man <span class="orange-text"><%= pacmanHighscores[4][0]%></span> <span class="green-text"><%= pacmanHighscores[4][1]%></span><br>Cookie-man Turbo <span class="orange-text"><%= pacmanHighscores[5][0]%></span> <span class="green-text"><%= pacmanHighscores[5][1]%></span></p>
    <iframe loading="lazy" class="mt-0 pt-0" id="gamepacman" src="..//files//pacman//index.htm" style="border: 0;display:block;"></iframe>
  </div>-->

  <!--BOUNCING ARROW
  <div class="aboveFalling arrowcontainer">
    <div class="arrow-holder">
      <div id="arrow" class="circle bounce">
          <i class="fas fa-angle-double-down fa-4x drop-arrow"></i>
      </div>
    </div>
  </div>-->

  <!--QUAVER ATTACK
  <iframe loading="lazy" class="aboveFalling mt-5 mx-auto" height="800" width="450" id="gamequaverattack" src="..//files//QuaverAttack//index.html" style="border: 0;display:block;"></iframe>-->

  <!--BOUNCING ARROW
  <div class="aboveFalling arrowcontainer">
    <div class="arrow-holder">
      <div id="arrow" class="circle bounce">
          <i class="fas fa-angle-double-down fa-4x drop-arrow"></i>
      </div>
    </div>
  </div>-->

  <!-- HEXTRIS
  <div style="max-width: 801px; margin:0 auto;">
    <div class="responsive-container-1-1">
      <iframe loading="lazy" class="aboveFalling responsive-iframe" src="https://hextris.io/"></iframe>
    </div>
  </div> -->



  <script>
  // ADD CSRF TOKEN TO MISSION SUBMITS
    if (document.getElementById('missionSubmitButton')) {
      var d1 = document.getElementById('missionSubmitButton')
      d1.insertAdjacentHTML('beforebegin', '<input type="hidden" name="_csrf" value="<%= csrfToken %>">')
      d1.insertAdjacentHTML('beforebegin', '<input type="hidden" name="userId" value="<%= userId %>">')
    }
  </script>

  <script>
    // DRAGGABLE WALLET
    var dragItem = document.querySelector(".draggable");
    var container = document.querySelector("#container");

    var active = false;
    var currentX;
    var currentY;
    var initialX;
    var initialY;
    var xOffset = 0;
    var yOffset = 0;

    container.addEventListener("touchstart", dragStart, false);
    container.addEventListener("touchend", dragEnd, false);
    container.addEventListener("touchmove", drag, false);

    container.addEventListener("mousedown", dragStart, false);
    container.addEventListener("mouseup", dragEnd, false);
    container.addEventListener("mousemove", drag, false);

    function dragStart(e) {
      if (e.type === "touchstart") {
        initialX = e.touches[0].clientX - xOffset;
        initialY = e.touches[0].clientY - yOffset;
      } else {
        initialX = e.clientX - xOffset;
        initialY = e.clientY - yOffset;
      }

      if (e.target === dragItem) {
        active = true;
      }
    }

    function dragEnd(e) {
      initialX = currentX;
      initialY = currentY;

      active = false;
    }

    function drag(e) {
      if (active) {
      
        e.preventDefault();
      
        if (e.type === "touchmove") {
          currentX = e.touches[0].clientX - initialX;
          currentY = e.touches[0].clientY - initialY;
        } else {
          currentX = e.clientX - initialX;
          currentY = e.clientY - initialY;
        }

        xOffset = currentX;
        yOffset = currentY;

        setTranslate(currentX, currentY, dragItem);
      }
    }

    function setTranslate(xPos, yPos, el) {
      el.style.transform = "translate3d(" + xPos + "px, " + yPos + "px, 0)";
    }

    // rainbow headings
      window.addEventListener("load", function() {
      let elements = document.getElementsByClassName("rainbowText");
      for (let i = 0; i < elements.length; i++) {
        generateRainbowText(elements[i]);
      }
    })
    
    function generateRainbowText(element) {
      let text = element.innerText;
      element.innerHTML = "";
      for (let i = 0; i < text.length; i++) {
        let charElem = document.createElement("span");
        charElem.style.color = "hsl(" + (360 * i / text.length) + ",100%,50%)";
        charElem.style.fontWeight = "bold";
        charElem.style.textShadow = "0px 4px 5px hsl(" + (360 * i / text.length) + ",80%,20%), 4px 0px 5px hsl(" + (360 * i / text.length) + ",80%,20%), -4px 0px 5px hsl(" + (360 * i / text.length) + ",80%,20%), 0px -4px 5px hsl(" + (360 * i / text.length) + ",80%,20%)";
        charElem.innerHTML = text[i];
        element.appendChild(charElem);
      }
    }
    </script>
</div>
    <!-- Footer -->
    <footer class="footer text-center small white-text py-3">
        <p class="m-0 raleway">Copyright &copy; <script>document.write(new Date().getFullYear());</script> <a href='/' class="white-text raleway">hanfordlam.com</a>. All rights reserved.</p>
        <p class="m-0">Background drawn by sweetcutiepie</p>
    </footer>
  </div> <!-- close out page container div -->
  <!-- BOOTSTRAP 5 -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
  <!-- TOOLTIPS -->
  <script>
    var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'))
    var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
      return new bootstrap.Tooltip(tooltipTriggerEl)
    })
    </script>
    <script src="../../main-bundled.js"></script>
  </body>
</html>