<!doctype html>
<html lang="en" id="missions-html">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <link rel="shortcut icon" href="favicon.png" type="image/x-icon">
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Caveat&family=Poppins&family=Recursive&family=Belgrano&family=Bellota&family=Handlee&family=Rye&family=ZCOOL+XiaoWei&display=swap" rel="stylesheet">
    <!-- bootstrap5-->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link rel="stylesheet" href="styles/style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>
    <title>Hanford Lam | Piano Teacher</title>
    <!-- CURSOR -->
    <style>HTML,BODY{cursor: url("../../images/cursor.cur"), auto;}</style>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-S7KLNXVSDD"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-S7KLNXVSDD');
    </script>
  </head>
  <body class="container-fluid background-transparent">
    <!-- NAVBAR -->
    <nav id="myNav" class="rounded recursive row align-items-center text-center py-2 w-auto">
      <div class="col-lg-5">
        <a id="navIcon" class="my-2 d-block" href='/'>Hanford Lam | Piano Teacher</a>
      </div>
      <div class="col-lg-7">
        <a id="practiceTab" href="/practice" class="mx-4 my-2 d-inline-block navLink">PRACTICE</a>
        <a id="missionsTab" href="/missions" class="mx-4 my-2 d-inline-block navLink">MISSIONS</a>
        <a id="leaderboardTab" href="/leaderboard" class="mx-4 my-2 d-inline-block navLink">LEADERBOARD</a>
        <form id="logoutButton" class="mx-4 my-2 d-inline-block" action="/logout" method="POST">
          <input type="hidden" name="_csrf" value="<%= csrfToken %>">
          <button type="submit" class="btn btn-sm btn-secondary">LOG OUT</button>
        </form>        
      </div>
    </nav>
    

      <!-- DYNAMIC NAVBAR AND TITLE -->
      <script>
        let currentPath = window.location.pathname
        if (currentPath == '/practice') {
          document.getElementById("practiceTab").classList.add("orange-text")
          document.title = "Portal - Hanford Lam"
        } else if (currentPath == '/missions') {
          document.getElementById("missionsTab").classList.add("orange-text")
          document.title = "Portal - Hanford Lam"
        } else if (currentPath == '/leaderboard') {
          document.getElementById("leaderboardTab").classList.add("orange-text")
          document.title = "Portal - Hanford Lam"
        }
      </script>
      <div id="container" class="container">
<!-- FONT AWESOME BOUNCING ARROW-->
<script src="https://kit.fontawesome.com/25ae9b8317.js" crossorigin="anonymous"></script>
<!-- PS2P font -->
<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">

<!-- ERRORS -->
<% adErrors.forEach(function(message) { %>
  <div class="alert alert-danger text-center small py-1 mt-2"><%= message %></div>
<% }) %>

<!--WALLET-->
<%- include('includes/wallet') %>

<!-- MINI MISSIONS -->
<!-- keep csrf token accessible, use lowercase for dataset entries! -->
<span id="csrf-landmark" data-value="<%= csrfToken %>" data-username="<%= username %>" data-studentid="<%= userId %>"></span>
<div id="mini-missions" class="section aboveFalling">
  <div class="py-4 my-4 mb-4 mx-0"><h1 class="px-5 display-2 recursive rainbowText text-center">MISSIONS</h1></div>
</div>
<!-- Guess the Tempo -->
<% if (BPMStatus == 'success') { %>
  <div id="bpm-success" class="aboveFalling green-text text-center mb-4 mt-4 pt-4">
    <img src='../images/metronome-colour.png' alt='blinking!' id='blinking_image' class="mb-4"/>
    <p>Spot on, <%= randomBPM %>! Your sense of timing is amazing.</p>
    <p>The Piano Wizard has put some points in your wallet.</p>
  </div>
<% } else if (BPMStatus == 'notQuite') { %>
  <div id="bpm-almost" class="aboveFalling pink-text text-center mb-4 mt-4 pt-4">
    <img src='../images/metronome-colour.png' alt='blinking!' id='blinking_image' class="mb-4"/>
    <p>Not quite! The tempo is <%= randomBPM %> beats per minute.<br>
    The Piano Wizard has put some points in your wallet.</p>
  </div>
<% } else { %>
  <form action="/guessBPM" method="POST" class="aboveFalling form-inline text-center mb-4 mt-4 justify-content-center">
    <img src='../images/metronome-colour.png' alt='blinking!' id='blinking_image' />
    <div class="form-group ml-4">
      <input type="range" min="20" max="200" step="10" name="bpmGuess" id="bpmGuess" class="input-lg mx-sm-3" oninput="num.value = this.value">
      <output style="width:3rem;" class="mr-0 pr-0 white-text" id="num">110</output>
      <small id="passwordHelpInline" class="text-muted">
        beats per minute
      </small>
      <input type="hidden" name="_csrf" value="<%= csrfToken %>">
      <button type="submit" class="btn btn-success ms-3">Guess</button>
    </div>
  </form>
<% } %>
<script>
  // Guess the tempo
  var img = document.getElementById('blinking_image');

  var interval = window.setInterval(function(){
    if (img.style.visibility == 'hidden') {
      img.style.visibility = 'visible';
    } else{
      img.style.visibility = 'hidden';
    }
  }, 30000/<%- randomBPM %>);
</script>

<div class="mt-5 aboveFalling" id="missionsWrapper">
<!-- Technical Skills -->
<% if (missionStatuses.technical) { %>
  <div class="rounded task-div-complete">
    <div class="missionContent">
      <h3 class=""><span class="dark-orange-text">Month</span><br>Technical<br>50</h3>
      <img src="../images/check-mark.png">
    </div>
  </div>
<% } else { %>
  <div class="rounded task-div-incomplete">
    <div class="missionContent">
      <h3 class=""><span class="dark-orange-text">Month</span><br>Technical<br>50</h3>
      <img src="../images/chronometer.png">
    </div> 
  </div>
<% }
if (missionStatuses.literacy) { %>
<div class="rounded task-div-complete">
  <div class="missionContent">
<h3 class=""><span class="dark-orange-text">Month</span><br>Literacy<br>50</h3>
  <img src="../images/check-mark.png">
  </div>
  
</div>
<% } else { %> 
<div class="rounded task-div-incomplete">
  <div class="missionContent">
    <h3 class=""><span class="dark-orange-text">Month</span><br>Literacy<br>50</h3>
    <img src="../images/chronometer.png">
  </div>  
</div>
<% }
if (missionStatuses.reading) { %>
<div class="rounded task-div-complete">
  <div class="missionContent">
    <h3 class=""><span class="dark-orange-text">Month</span><br>Reading<br>50</h3>
    <img src="../images/check-mark.png">
  </div>
</div> 
<% } else { %> 
<div class="rounded task-div-incomplete">
  <div class="missionContent">
    <h3 class=""><span class="dark-orange-text">Month</span><br>Reading<br>50</h3>
    <img src="../images/chronometer.png">
  </div>  
</div>
<% }

if (missionStatuses.perform) { %>
<div class="rounded task-div-complete">
  <div class="missionContent">
<h3 class=""><span class="dark-orange-text">Term</span><br>Perform<br>300</h3>
  <img src="../images/check-mark.png">
  </div>
  
</div> 
<% } else { %>  
<div class="rounded task-div-incomplete">
  <div class="missionContent">
    <h3 class=""><span class="dark-orange-text">Term</span><br>Perform<br>300</h3>
    <img src="../images/chronometer.png">
  </div>  
</div>
<% }
if (missionStatuses.exam) { %>
<div class="rounded task-div-complete">
  <div class="missionContent">
<h3 class=""><span class="dark-orange-text">Year</span><br>Exam<br>500</h3>
  <img src="../images/check-mark.png">
  </div>
  
</div> 
<% } else { %>   
<div class="rounded task-div-incomplete">
  <div class="missionContent">
    <h3 class=""><span class="dark-orange-text">Year</span><br>Exam<br>500</h3>
    <img src="../images/chronometer.png">
  </div>  
</div>
<% }
if (missionStatuses.compete) { %>
  <div class="rounded task-div-complete">
    <div class="missionContent">
<h3 class=""><span class="dark-orange-text">Year</span><br>Compete<br>500</h3>
    <img src="../images/check-mark.png">
    </div>
    
  </div> 
<% } else { %>   
<div class="rounded task-div-incomplete">
  <div class="missionContent">
    <h3 class=""><span class="dark-orange-text">Year</span><br>Compete<br>500</h3>
    <img src="../images/chronometer.png">
  </div>  
</div>
<% } %>

<!--BOUNCING ARROW-->
<div class="aboveFalling arrowcontainer">
  <div class="arrow-holder">
    <div id="arrow" class="circle bounce">
        <i class="fas fa-angle-double-down fa-4x drop-arrow"></i>
    </div>
  </div>
</div>

<!-- INTERESTING VIDEO -->
<div id="interestingVideoContainer" class="aboveFalling">
  <% if(interestingVideoURL){ %>
  <p class="blue-box text-center mb-5 rounded recursive"><%= interestingVideoPrompt %></p>
  <div class="responsive-container">
    <iframe style="z-index: 99999;" class="mb-5" width="100%" height="500px" src="<%= interestingVideoURL %>" title="Hanford's Video Pick" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
  </div>
  <% } %>
</div>

<!--BOUNCING ARROW-->
<div class="aboveFalling arrowcontainer">
  <div class="arrow-holder">
    <div id="arrow" class="circle bounce">
        <i class="fas fa-angle-double-down fa-4x drop-arrow"></i>
    </div>
  </div>
</div>

<!-- READING PRACTICE -->
<div id="readingPracticeContainer" class="aboveFalling">
  <% if(readingPracticePDFPath){ %>
  <p class="blue-box text-center rounded recursive"><%= readingPracticePrompt %></p>
  <p class="blue-box text-center rounded recursive mb-5">Here is the <a href="<%= readingPracticePDFPath %>" target="_blank">PDF</a> file.</p>
  <iframe src="<%= readingPracticePDFPath %>" width="100%" height="1000px"></iframe>
  <% } %>
</div>

<!--BOUNCING ARROW-->
<div class="aboveFalling arrowcontainer">
  <div class="arrow-holder">
    <div id="arrow" class="circle bounce">
        <i class="fas fa-angle-double-down fa-4x drop-arrow"></i>
    </div>
  </div>
</div>

<!--2048-->
<div style="margin: 0 auto; max-width:800px;"><iframe class="aboveFalling rounded mt-5" id="game2048" src="..//files//2048//index.html" frameborder="0"></iframe></div>

<!--BOUNCING ARROW-->
<div class="aboveFalling arrowcontainer">
  <div class="arrow-holder">
    <div id="arrow" class="circle bounce">
        <i class="fas fa-angle-double-down fa-4x drop-arrow"></i>
    </div>
  </div>
</div>

<!--pacman-->
<div class="aboveFalling white-text text-center mt-5 mb-0 pt-4 pb-0 ps2p" style="background-color:#000; max-width: 800px; margin: 0 auto;">
  <p class="my-3 purple-text">GLOBAL HIGHSCORES</p>
  <p>Pac-man: <span class="orange-text"><%= pacmanHighscores[0][0]%></span> <span class="green-text"><%= pacmanHighscores[0][1]%></span><br>Pac-man Turbo <span class="orange-text"><%= pacmanHighscores[1][0]%></span> <span class="green-text"><%= pacmanHighscores[1][1]%></span></p>
  <p>Ms Pac-man <span class="orange-text"><%= pacmanHighscores[2][0]%></span> <span class="green-text"><%= pacmanHighscores[2][1]%></span><br>Ms Pac-man Turbo <span class="orange-text"><%= pacmanHighscores[3][0]%></span> <span class="green-text"><%= pacmanHighscores[3][1]%></span></p>
  <p class="mb-0 pb-0">Cookie-man <span class="orange-text"><%= pacmanHighscores[4][0]%></span> <span class="green-text"><%= pacmanHighscores[4][1]%></span><br>Cookie-man Turbo <span class="orange-text"><%= pacmanHighscores[5][0]%></span> <span class="green-text"><%= pacmanHighscores[5][1]%></span></p>
  <iframe class="mt-0 pt-0" id="gamepacman" src="..//files//pacman//index.htm" style="border: 0;display:block;"></iframe>
</div>

<!--BOUNCING ARROW-->
<div class="aboveFalling arrowcontainer">
  <div class="arrow-holder">
    <div id="arrow" class="circle bounce">
        <i class="fas fa-angle-double-down fa-4x drop-arrow"></i>
    </div>
  </div>
</div>

<!--QUAVER ATTACK-->
<iframe class="aboveFalling mt-5 mx-auto" height="800" width="450" id="gamequaverattack" src="..//files//QuaverAttack//index.html" style="border: 0;display:block;"></iframe>

<script>
// ADD CSRF TOKEN TO MISSION SUBMITS
  if (document.getElementById('missionSubmitButton')) {
    var d1 = document.getElementById('missionSubmitButton')
    d1.insertAdjacentHTML('beforebegin', '<input type="hidden" name="_csrf" value="<%= csrfToken %>">')
    d1.insertAdjacentHTML('beforebegin', '<input type="hidden" name="userId" value="<%= userId %>">')
  }
</script>

<%- include('includes/footer') %>