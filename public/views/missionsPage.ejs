<%- include('includes/header') %>

<!-- ERRORS -->
<% adErrors.forEach(function(message) { %>
  <div class="alert alert-danger text-center small py-1 mt-2"><%= message %></div>
<% }) %>

<!-- GREETINGS -->
<div class="text-center mb-2 mt-3">
  <a href="/practice" type="button" class="mx-2 my-1 btn btn-outline-info btn-lg">Practice</a>
  <a href="/missions" type="button" class="mx-2 my-1 btn btn-outline-danger btn-lg">Missions</a>
  <a href="/leaderboard" type="button" class="mx-2 my-1 btn btn-outline-success btn-lg">Points</a>
  <a href="/parents" type="button" class="mx-2 my-1 btn btn-outline-warning btn-lg">Parents</a>
</div>

<!-- MINI MISSIONS -->
<!-- keep csrf token accessible -->
<p id="csrf-landmark" data-value="<%= csrfToken %>"></p>
<div id="mini-missions" class="section">
  <div class="py-4 my-4 mb-4 mx-0"><h1 class="px-5 display-2 recursive rainbowText text-center">MISSIONS</h1>
    <h2 class="white-text text-center handlee pb-2 pt-0 mt-0">
      <% let i = 0;
      Object.values(missionStatuses).forEach((value) => {
        if(value){
          i += 1;
        }
      })
      if(i==1){ %>
        1 mission complete
      <% }else{ %>
      <%= i %> missions complete
      <% } %></h2></div>
</div>
<!-- Guess the Tempo -->
<div class="green-text text-center">#Tempo and Pulse</div>
<% if (BPMStatus == 'success') { %>
  <div id="bpm-success" class="alert alert-success text-center mb-4 mt-2 pt-4">
    <img src='../images/metronome-colour.png' alt='blinking!' id='blinking_image' class="mb-4"/>
    <p>Spot on, <%= randomBPM %>! Your sense of timing is amazing.</p>
    <p>The Piano Wizard has granted you a bunch of Piano Points for your achievement.</p>
    <p>Guess again tomorrow!</p>
  </div>
<% } else if (BPMStatus == 'notQuite') { %>
  <div id="bpm-almost" class="alert alert-warning text-center mb-4 mt-2 pt-4">
    <img src='../images/metronome-colour.png' alt='blinking!' id='blinking_image' class="mb-4"/>
    <p>Not quite! The tempo is <%= randomBPM %> beats per minute.</p>
    <p>The Piano Wizard has granted you some encouragement Piano Points.</p>
    <p>Guess again tomorrow!</p>
  </div>
<% } else { %>
  <form action="/guessBPM" method="POST" class="alert alert-primary form-inline text-center mb-3 mt-3 justify-content-center">
    <img src='../images/metronome-colour.png' alt='blinking!' id='blinking_image' />
    <div class="form-group ml-4">
      <input type="text" name="bpmGuess" id="bpmGuess" class="form-control input-lg mx-sm-3">
      <small id="passwordHelpInline" class="text-muted">
        beats per minute
      </small>
    </div>
    <input type="hidden" name="_csrf" value="<%= csrfToken %>">
    <button type="submit" class="btn btn-success ml-3">Guess</button>
  </form>
<% } %>

<!-- Technical Skills -->
<div class="green-text text-center mt-5 pt-5">#Scales and Arpeggios</div>
<div class="text-center">
<% if (missionStatuses.majorScales) { %>
  <div class="py-3 mx-5 my-2 rounded task-div-complete">
  <h3 class="pink-text">50 Piano Points : <span class="small">Major scales</span></h3>
  <h3 class="recursive correct-text">Done!</h3><img src="../images/check-mark.png">
</div>
<% } else { %>
  <div class="py-3 mx-5 my-2 rounded task-div-incomplete">
  <h3 class="pink-text">50 Piano Points : <span class="small">Major scales</span></h3>
  <h3 class="recursive pink-text">Not yet...</h3><img src="../images/chronometer.png">
</div>
<% }
if (missionStatuses.minorScales) { %>
<div class="py-3 mx-5 my-2 rounded task-div-complete">
  <h3 class="pink-text">50 Piano Points : <span class="small">Minor scales</span></h3>
  <h3 class="recursive correct-text">Done!</h3><img src="../images/check-mark.png">
</div> 
<% } else { %> 
<div class="py-3 mx-5 my-2 rounded task-div-incomplete">
  <h3 class="pink-text">50 Piano Points : <span class="small">Minor scales</span></h3>
  <h3 class="recursive pink-text">Not yet...</h3><img src="../images/chronometer.png">
</div>
<% }
if (missionStatuses.majorArpeggios) { %>
<div class="py-3 mx-5 my-2 rounded task-div-complete">
  <h3 class="pink-text">50 Piano Points : <span class="small">Major arpeggios</span></h3>
  <h3 class="recursive correct-text">Done!</h3><img src="../images/check-mark.png">
</div>
<% } else { %> 
<div class="py-3 mx-5 my-2 rounded task-div-incomplete">
  <h3 class="pink-text">50 Piano Points : <span class="small">Major arpeggios</span></h3>
  <h3 class="recursive pink-text">Not yet...</h3><img src="../images/chronometer.png">
</div>
<% }
if (missionStatuses.minorArpeggios) { %>
<div class="py-3 mx-5 my-2 rounded task-div-complete">
  <h3 class="pink-text">50 Piano Points : <span class="small">Minor arpeggios</span></h3>
  <h3 class="recursive correct-text">Done!</h3><img src="../images/check-mark.png">
</div> 
<% } else { %>  
<div class="py-3 mx-5 my-2 rounded task-div-incomplete">
  <h3 class="pink-text">50 Piano Points : <span class="small">Minor arpeggios</span></h3>
  <h3 class="recursive pink-text">Not yet...</h3><img src="../images/chronometer.png">
</div>
<% }
if (missionStatuses.scaleModes) { %>
<div class="py-3 mx-5 my-2 rounded task-div-complete">
  <h3 class="pink-text">50 Piano Points : <span class="small">Scale modes</span></h3>
  <h3 class="recursive correct-text">Done!</h3><img src="../images/check-mark.png">
</div> 
<% } else { %>   
<div class="py-3 mx-5 my-2 rounded task-div-incomplete">
  <h3 class="pink-text">50 Piano Points : <span class="small">Scale modes</span></h3>
  <h3 class="recursive pink-text">Not yet...</h3><img src="../images/chronometer.png">
</div>
<% }
if (missionStatuses.arpeggioInversions) { %>
  <div class="py-3 mx-5 my-2 rounded task-div-complete">
    <h3 class="pink-text">50 Piano Points : <span class="small">Arpeggio inversions</span></h3>
    <h3 class="recursive correct-text">Done!</h3><img src="../images/check-mark.png">
  </div> 
<% } else { %>   
<div class="py-3 mx-5 my-2 rounded task-div-incomplete">
  <h3 class="pink-text">50 Piano Points : <span class="small">Arpeggio inversions</span></h3>
  <h3 class="recursive pink-text">Not yet...</h3><img src="../images/chronometer.png">
</div>
<% }
if (missionStatuses.chromatic) { %>
  <div class="py-3 mx-5 my-2 rounded task-div-complete">
    <h3 class="pink-text">50 Piano Points : <span class="small">Chromatic scales</span></h3>
    <h3 class="recursive correct-text">Done!</h3><img src="../images/check-mark.png">
  </div> 
<% } else { %>   
<div class="py-3 mx-5 my-2 rounded task-div-incomplete">
  <h3 class="pink-text">50 Piano Points : <span class="small">Chromatic scales</span></h3>
  <h3 class="recursive pink-text">Not yet...</h3><img src="../images/chronometer.png">
</div>
<% } %>
</div>

<!-- Sight Reading-->
<div class="green-text text-center mt-5">#Reading</div>
<div class="text-center">
<% if (missionStatuses.ningenius) { %>
  <div class="py-3 mx-5 my-2 rounded task-div-complete">
  <h3 class="pink-text">50 Piano Points : <span class="small">NinGenius</span></h3>
  <h3 class="recursive correct-text">Done!</h3><img src="../images/check-mark.png">
</div>
<% } else { %>
  <div class="py-3 mx-5 my-2 rounded task-div-incomplete">
  <h3 class="pink-text">50 Piano Points : <span class="small">NinGenius</span></h3>
  <p>This is a game on Hanford's iPad.</p>
  <h3 class="recursive pink-text">Not yet...</h3><img src="../images/chronometer.png">
</div>
<% } %>
<% if (missionStatuses.sightReading) { %>
  <div class="py-3 mx-5 my-2 rounded task-div-complete">
  <h3 class="pink-text">50 Piano Points : <span class="small">Sight-reading</span></h3>
  <h3 class="recursive correct-text">Done!</h3><img src="../images/check-mark.png">
</div>
<% } else { %>
  <div class="py-3 mx-5 my-2 rounded task-div-incomplete">
  <h3 class="pink-text">50 Piano Points : <span class="small">Sight-reading</span></h3>
  <p>Practice by reading any music you can get your hands on. <br>
    Online, old books, and Hanford's library are good places to start.</p>
  <h3 class="recursive pink-text">Not yet...</h3><img src="../images/chronometer.png">
</div>
<% } %>

<!-- Listening Skills-->
<div class="green-text text-center mt-5">#Listening</div>
<div class="text-center">
<% if (missionStatuses.oneTimeAuralMemory) { %>
  <div class="py-3 mx-5 my-2 rounded task-div-complete">
  <h3 class="pink-text">50 Piano Points : <span class="small">Melodic memory</span></h3>
  <h3 class="recursive correct-text">Done!</h3><img src="../images/check-mark.png">
</div>
<% } else { %>
  <div class="py-3 mx-5 my-2 rounded task-div-incomplete">
  <h3 class="pink-text">50 Piano Points : <span class="small">Melodic memory</span></h3>
  <p>Hanford will play a melody on the piano for you to sing back.</p>
  <h3 class="recursive pink-text">Not yet...</h3><img src="../images/chronometer.png">
</div>
<% } %>
<% if (missionStatuses.noteMemoryGame) { %>
  <div class="py-3 mx-5 my-2 rounded task-div-complete">
  <h3 class="pink-text">50 Piano Points : <span class="small"><em>Note Memory</em> game</span></h3>
  <h3 class="recursive correct-text">Done!</h3><img src="../images/check-mark.png">
</div>
<% } else { %>
  <div class="py-3 mx-5 my-2 rounded task-div-incomplete">
  <h3 class="pink-text">50 Piano Points : <span class="small"><em>Note Memory</em> game</span></h3>
  <p>We take turns building up our sequence.</p>
  <h3 class="recursive pink-text">Not yet...</h3><img src="../images/chronometer.png">
</div>
<% } %>

<!-- Creative Skills-->
<div class="green-text text-center mt-5">#Creativity and Problem Solving</div>
<% if (missionStatuses.mastermind) { %>
  <div class="py-3 mx-5 my-2 rounded task-div-complete">
  <h3 class="pink-text">50 Piano Points : <span class="small">MasterMind</span></h3>
  <h3 class="recursive correct-text">Done!</h3><img src="../images/check-mark.png">
</div>
<% } else { %>
  <div class="py-3 mx-5 my-2 rounded task-div-incomplete">
  <h3 class="pink-text">50 Piano Points : <span class="small">MasterMind</span></h3>
  <p>This is a game with some strategy and some luck.</p>
  <h3 class="recursive pink-text">Not yet...</h3><img src="../images/chronometer.png">
</div>
<% } %>
<% if (missionStatuses.contributeStory) { %>
  <div class="py-3 mx-5 my-2 rounded task-div-complete">
  <h3 class="pink-text">50 Piano Points : <span class="small">Creative writing</span></h3>
  <h3 class="recursive correct-text">Done!</h3><img src="../images/check-mark.png">
</div>
<% } else { %>
  <div class="py-3 mx-5 my-2 rounded task-div-incomplete">
  <h3 class="pink-text">50 Piano Points : <span class="small">Creative writing</span></h3>
  <p>An imaginative writing task.</p>
  <h3 class="recursive pink-text">Not yet...</h3><img src="../images/chronometer.png">
</div>
<% } %>

<!-- Knowledge and Facts -->
<div class="green-text text-center mt-5">#Knowledge and Facts</div>
<% if (missionStatuses.essayWriting) { %>
  <div class="py-3 mx-5 my-2 rounded task-div-complete">
  <h3 class="pink-text">50 Piano Points : <span class="small">Essay Writing</span></h3>
  <h3 class="recursive correct-text">Done!</h3><img src="../images/check-mark.png">
</div>
<% } else { %>
  <div class="py-3 mx-5 my-2 rounded task-div-incomplete">
  <h3 class="pink-text">50 Piano Points : <span class="small">Essay Writing</span></h3>
  <p>Your best research on a topic given by Hanford.</p>
  <h3 class="recursive pink-text">Not yet...</h3><img src="../images/chronometer.png">
</div>
<% } %>

<!-- Performance Skills-->
<div class="green-text text-center mt-5">#Performance</div>
<div class="text-center">
<% if (missionStatuses.recitalPerformer) { %>
  <div class="py-3 mx-5 my-2 rounded task-div-complete">
  <h3 class="pink-text">50 Piano Points : <span class="small">Perform in a recital</span></h3>
  <h3 class="recursive correct-text">Done!</h3><img src="../images/check-mark.png">
</div>
<% } else { %>
  <div class="py-3 mx-5 my-2 rounded task-div-incomplete">
  <h3 class="pink-text">50 Piano Points : <span class="small">Perform in a recital</span></h3>
  <p>Everyone should give this a go.</p>
  <h3 class="recursive pink-text">Not yet...</h3><img src="../images/chronometer.png">
</div>
<% } %>
<% if (missionStatuses.examTaker) { %>
  <div class="py-3 mx-5 my-2 rounded task-div-complete">
  <h3 class="pink-text">50 Piano Points : <span class="small">Formal/Informal exam</span></h3>
  <h3 class="recursive correct-text">Done!</h3><img src="../images/check-mark.png">
</div>
<% } else { %>
  <div class="py-3 mx-5 my-2 rounded task-div-incomplete">
  <h3 class="pink-text">50 Piano Points : <span class="small">Formal/Informal exam</span></h3>
  <p>Exams help tell us what we can do really well under pressure and what we can't yet.</p>
  <h3 class="recursive pink-text">Not yet...</h3><img src="../images/chronometer.png">
</div>
<% } %>

<!-- Games-->
<div class="green-text text-center mt-5">#Arcade Games</div>
<div class="purple-text text-center">Coming next year!</div>

<!--LOGOUT-->
<form id="logoutButton" class="mt-5" action="/logout" method="POST">
  <input type="hidden" name="_csrf" value="<%= csrfToken %>">
  <button type="submit" class="btn btn-primary btn-lg btn-block">Log Out</button>
</form>

<script>
  // Guess the tempo
  var img = document.getElementById('blinking_image');

  var interval = window.setInterval(function(){
    if (img.style.visibility == 'hidden') {
      img.style.visibility = 'visible';
    } else{
      img.style.visibility = 'hidden';
    }
  }, 30000/<%- randomBPM %>);

// ADD CSRF TOKEN TO MISSION SUBMITS
  if (document.getElementById('missionSubmitButton')) {
    var d1 = document.getElementById('missionSubmitButton')
    d1.insertAdjacentHTML('beforebegin', '<input type="hidden" name="_csrf" value="<%= csrfToken %>">')
    d1.insertAdjacentHTML('beforebegin', '<input type="hidden" name="userId" value="<%= userId %>">')
  }

</script>

<%- include('includes/footer') %>